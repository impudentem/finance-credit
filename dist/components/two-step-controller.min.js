var twoStepController;twoStepController=function(){function t(t,e,a,n,r,i,o,s,m){this.$http=t,this.$scope=e,this.$rootScope=a,this.$sce=n,this.$location=r,this.$element=i,this.$sceDelegate=o,this.$filter=s,this.$timeout=m,this.calendar={},this.$scope.$watch(function(t){return function(e,a,n){return t.$scope.main.currentStep}}(this),function(t){return function(e,a,n){if(t.$iElement=$(t.$element),2===(e=parseInt(e)))return t.init()}}(this))}return t.prototype.card_hover=function(t,e){return this.$scope.cards_two.card_hover="mouseover"===t.type?e:""},t.prototype.formatter=function(t){var e,a,n;return t?(e=""+t.getDate(),a=""+(t.getMonth()+1),e=e.length<2?"0"+t.getDate():""+t.getDate(),a=a.length<2?"0"+(t.getMonth()+1):""+(t.getMonth()+1),n=""+t.getFullYear(),e+"."+a+"."+n):""},t.prototype.init=function(){return this.calendar={},this.minDate=new Date,this.maxDate=new Date,this.maxDate.setFullYear(this.maxDate.getFullYear()-18),this.minDate.setFullYear(this.minDate.getFullYear()-90),this.minDateMob=moment(this.minDate).format("YYYY-MM-DD"),this.maxDateMob=moment(this.maxDate).format("YYYY-MM-DD"),this.initCal=function(t){return function(){var e,a;return t.calendar=t.$iElement.find("button.daterange").daterangepicker({singleDatePicker:!0,showDropdowns:!0,locale:{format:"DD.MM.YYYY",separator:" - ",applyLabel:"Ок",cancelLabel:"Отмена",fromLabel:"С",toLabel:"По",customRangeLabel:"Custom",weekLabel:"W",daysOfWeek:["В","П","В","С","Ч","П","С"],monthNames:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],firstDay:1},opens:"left",minDate:t.formatter(t.minDate),maxDate:t.formatter(t.maxDate),startDate:t.$scope.$storage.strgData.bday?moment(t.$scope.$storage.strgData.bday,"DD.MM.YYYY").toDate():t.maxDate},function(e,a,n){var r,i;if(i=$(t.$element).find(".ui.form"),i=i.data("module-form"),r=e.format("DD.MM.YYYY"),t.$scope.$storage.strgData.bday=r,t.mob_trigger_calendar_input.val(moment(r,"DD.MM.YYYY").format("YYYY-MM-DD")),t.$scope.$$phase||t.$scope.$apply(),i&&!0!==i.is.valid())return i.validate.form()}),t.calendar_input=t.$iElement.find("input[name='bday']"),t.mob_trigger_calendar_input=t.$iElement.find("input[name='mobtriggerbday']"),t.$rootScope.isMobile&&t.mob_trigger_calendar_input.on("change",function(e){var a,n,r;if(a=t.isValidRange(e.target.value,"YYYY-MM-DD")?moment(e.target.value,"YYYY-MM-DD").format("DD.MM.YYYY"):moment(t.maxDate).format("DD.MM.YYYY"),t.$scope.$storage.strgData.bday=a,t.calendar.data("daterangepicker").setStartDate("function"==typeof(n=moment(a,"DD.MM.YYYY")).toDate?n.toDate():void 0),t.calendar.data("daterangepicker").setEndDate("function"==typeof(r=moment(a,"DD.MM.YYYY")).toDate?r.toDate():void 0),!t.$scope.$$phase)return t.$scope.$apply()}),t.calendar_input.on("change",function(e){var a;return t.calendar.data("daterangepicker").setStartDate(t.calendar_input.inputmask("isComplete")?moment(e.target.value,"DD.MM.YYYY").toDate():t.maxDate),t.calendar.data("daterangepicker").setEndDate(t.calendar_input.inputmask("isComplete")?moment(e.target.value,"DD.MM.YYYY").toDate():t.maxDate),a=moment(e.target.value,"DD.MM.YYYY").format("YYYY-MM-DD"),t.mob_trigger_calendar_input.val(a)}).inputmask({placeholder:"__.__.____",alias:"dd.mm.yyyy",yearrange:{minyear:t.minDate.getFullYear(),maxyear:t.maxDate.getFullYear()},greedy:!1,showMaskOnHover:!1}),t.$scope.$storage.strgData.bday&&(a=t.isValidRange(t.$scope.$storage.strgData.bday,"DD.MM.YYYY")?t.$scope.$storage.strgData.bday:moment(t.maxDate).format("DD.MM.YYYY"),t.calendar_input.val(a),t.$rootScope.isMobile&&(e=moment(a,"DD.MM.YYYY").format("YYYY-MM-DD"),t.mob_trigger_calendar_input.val(e))),t.initMask()}}(this),this.$timeout(function(t){return function(){return t.initCal()}}(this))},t.prototype.isValidRange=function(t,e){return moment(t,e).unix()<=moment(this.maxDate).unix()&&moment(t,e).unix()>=moment(this.minDate).unix()},t.prototype.prevStep=function(){return this.$scope.main.$location.path("/s1"),this.$scope.main.loading=!0},t.prototype.nextStep=function(){var t;if(t=$(this.$element).find(".ui.form"),(t=t.data("module-form"))&&t.is.valid()){if(this.$scope.main.loading=!0,this.$location.path("/s3"),!this.$scope.$$phase)return this.$scope.$apply()}else if(t)return t.validate.form()},t.prototype.initMask=function(){var t,e,a,n;return void 0===this.$scope.$storage.strgData.aggree&&(this.$scope.$storage.strgData.aggree=!0),a=[39,50,63,66,67,68,73,91,92,93,94,95,96,97,98,99],function(){var t,e,r;for(r=[],t=0,e=a.length;t<e;t++)n=a[t],r.push({mask:"+38 (0"+n+") ###-##-##",cc:"UA",cd:"Ukraine"});return r}(),t=$('input[name="phone"]'),e=this,t.mask("+38 (099) 999-99-99",{completed:function(){return e.$scope.$storage.strgData.phone=this.val()}}),new Inputmask("U{1,64} (U{1,64})|(U{1,64} U{1,64})",{greedy:!1,showMaskOnHover:!1,oncomplete:function(t){return function(e){return t.$scope.$storage.strgData.name=e.target.value}}(this)}).mask($('input[name="fullname"]')[0]),this.$scope.main.loading=!1,$.fn.form.settings.rules.dateRange=function(t,e){var a,n,r,i,o,s;return n=$("input[name='bday']"),a=$("button.daterange").data("daterangepicker"),r=null!=a?a.maxDate.unix():void 0,s=this[0],(s=s.validity?null!=(o=s.validity)?o.valid:void 0:"function"==typeof s.checkValidity?s.checkValidity():void 0)&&(s=n.inputmask("isComplete")),s&&(s=("function"==typeof(i=moment(n.val(),"DD.MM.YYYY")).unix?i.unix():void 0)<=r),s},$(this.$element).find(".ui.form").form({inline:!0,on:"blur",fields:{fullname:{identifier:"fullname",rules:[{type:"regExp[/^([а-яёієыї\\-\\']+\\s[а-яёієыї\\-\\']+)?(\\s[а-яёієыї\\-\\']+)?$/i]",prompt:"Введены недопустимые символы"},{type:"empty",prompt:"Укажите Имя и Фамилию"}]},bday:{identifier:"bday",rules:[{type:"regExp[/^\\d{2}[\\.]\\d{2}[\\.]\\d{4}$/i]",prompt:"Неправильная дата рождения"},{type:"dateRange",prompt:"Кредит могут получить лица возрастом от 18 до 90 лет"}]},phone:{identifier:"phone",rules:[{type:"regExp[/^\\+38\\s\\(0\\d{2}\\)\\s\\d{3}\\-\\d{2}\\-\\d{2}$/i]",prompt:"Неправильный номер телефона"},{type:"empty",prompt:"Вы не указали номер телефона"}]},aggree:{identifier:"aggree",rules:[{type:"checked",prompt:"Так мы не сможем обработать Ваш запрос"}]}}})},t}();