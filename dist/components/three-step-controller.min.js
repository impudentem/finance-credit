var threeStepController;threeStepController=function(){function t(t,e,n,i,o,r,s,c,u){this.$http=t,this.$scope=e,this.$rootScope=n,this.$sce=i,this.$location=o,this.$element=r,this.$sceDelegate=s,this.$filter=c,this.$timeout=u,this.data={cities:{},employments:{}},this.$scope.$watch(function(t){return function(e,n,i){return t.$scope.main.currentStep}}(this),function(t){return function(e,n,i){return t.$iElement=$(t.$element),3===(e=parseInt(e))&&t.init("cities",function(t){return t&&"success"===t.result&&(this.data.cities=t.data),this.init("employments",function(t){if(t&&"success"===t.result)return this.data.employments=t.data})}),!1}}(this)),this.$scope.$watch(function(t){return function(e,n,i){return t.data}}(this),function(t){return function(e,n,i){if(Object.size(t.data.cities)&&Object.size(t.data.employments))return t.update()}}(this),!0)}return t.prototype.card_hover=function(t,e){return this.$scope.cards_three.card_hover="mouseover"===t.type?e:""},t.prototype.update=function(){var t,e;return t=this.$iElement.find(".ui.dropdown.city").dropdown({allowAdditions:!0,onChange:function(t){return function(e,n,i){return t.$scope.$storage.strgData.city=n,t.$scope.$storage.strgData.city_val=e}}(this)}),e=this.$iElement.find(".ui.dropdown.employment").dropdown({onChange:function(t){return function(e,n,i){return t.$scope.$storage.strgData.employment=e}}(this)}),this.$iElement.find(".ui.checkbox.noinn").checkbox().first().checkbox({onChecked:function(t){return function(){return t.chngMsg("remove")}}(this),onUnchecked:function(t){return function(){return t.chngMsg("add")}}(this)}),this.$scope.$storage.strgData.city_val&&this.$timeout(function(e){return function(){return t.data("module-dropdown").set.selected(e.$scope.$storage.strgData.city)}}(this)),this.$scope.$storage.strgData.employment&&this.$timeout(function(t){return function(){return e.data("module-dropdown").set.selected(t.$scope.$storage.strgData.employment)}}(this)),$(this.$element).find("form").form({inline:!0,on:"blur",fields:{employment:{identifier:"employment",rules:[{type:"empty",prompt:"Выберите трудоустройство"}]},city:{identifier:"city",rules:[{type:"empty",prompt:"Введите ваш город"}]}},onSuccess:function(t){return function(e,n){return t.$scope.main.loading=!0,!1}}(this)}),this.chngMsg("add"),this.$scope.main.loading=!1},t.prototype.chngMsg=function(t){var e,n;return n=$(this.$element).find("form"),e=this.$iElement.find(".ui.button.submit"),"add"===t?(n.form("add rule","inn",{rules:[{type:"integer[10]",prompt:"Неправильный ИНН"}]}),e.popup({transition:"horizontal flip",position:"right center",target:"#inn",content:"Без ИНН шансы на получение кредита значительно уменьшаются. Часть банков не будет рассматривать заявку, если отправить её без ИНН."})):(n.form("remove fields",["inn"]),n.form("validate field","inn"),e.popup("destroy"))},t.prototype.init=function(t,e){var n,i;if(this.fn=e,t)return n={data:t},i=this.$sceDelegate.trustAs(this.$sce.RESOURCE_URL,""+this.$rootScope.settings.api.url+this.$rootScope.settings.api.command.get),this.$http.jsonp(i,{params:n}).then(function(t){return function(e){return"function"==typeof t.fn?t.fn(e.data,function(e){return"function"==typeof t.fn?t.fn(e.data):void 0}):void 0}}(this))},t.prototype.post=function(t,e){var n,i;if(this.fn=e,t)return n={data:t},i=this.$sceDelegate.trustAs(this.$sce.RESOURCE_URL,""+this.$rootScope.settings.api.url+this.$rootScope.settings.api.command.get),this.$http.jsonp(i,{params:n}).then(function(t){return function(e){return"function"==typeof t.fn?t.fn(e.data,function(e){return"function"==typeof t.fn?t.fn(e.data):void 0}):void 0}}(this))},t}();